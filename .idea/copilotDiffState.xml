<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/components/Navbar.tsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/components/Navbar.tsx" />
              <option name="originalContent" value="'use client';&#10;&#10;import Link from 'next/link';&#10;import Image from 'next/image';&#10;import { useEffect, useMemo, useRef, useState } from 'react';&#10;import { usePathname } from 'next/navigation';&#10;import { Home, BookOpen, Phone as PhoneIcon, Store as StoreIcon, Building2 } from 'lucide-react';&#10;import type { LucideIcon } from 'lucide-react;&#10;&#10;// Link type for nav items&#10;type NavItem = {&#10;  label: string;&#10;  href: string; // can be &quot;/#section&quot; or a route&#10;  sectionId?: string; // present if it's a home section link&#10;};&#10;&#10;// A fresh, polished navbar optimized for the homepage but safe globally&#10;export default function Navbar() {&#10;  const pathname = usePathname();&#10;  const isHome = pathname === '/';&#10;&#10;  const [scrolled, setScrolled] = useState(false);&#10;  const [active, setActive] = useState&lt;string&gt;(() =&gt; {&#10;    // Initialize based on URL hash if present, otherwise default to home&#10;    if (typeof window !== 'undefined') {&#10;      const hash = window.location.hash.replace('#', '');&#10;      return hash || 'home';&#10;    }&#10;    return 'home';&#10;  });&#10;  const [mobileOpen, setMobileOpen] = useState(false);&#10;  const headerRef = useRef&lt;HTMLElement | null&gt;(null);&#10;  const topBarRef = useRef&lt;HTMLDivElement | null&gt;(null);&#10;  const bottomBarRef = useRef&lt;HTMLDivElement | null&gt;(null);&#10;&#10;  // Central definition of links; section links are anchored to home&#10;  const links: NavItem[] = useMemo(&#10;    () =&gt; [&#10;      { label: 'Home', href: '/#home', sectionId: 'home' },&#10;      { label: 'Our Story', href: '/#our-story', sectionId: 'our-story' },&#10;      { label: 'Menu', href: '/#menu', sectionId: 'menu' },&#10;      { label: 'Gallery', href: '/#gallery', sectionId: 'gallery' },&#10;      // Removed 'Franchise' from main links to avoid repetition with CTA&#10;      { label: 'Store Locator', href: '/store-locator' },&#10;      { label: 'Contact', href: '/contact' },&#10;    ],&#10;    []&#10;  );&#10;&#10;  // Close mobile menu on route change and handle section activation&#10;  useEffect(() =&gt; {&#10;    setMobileOpen(false);&#10;&#10;    // Reset active section when navigating to/from home&#10;    if (isHome) {&#10;      const hash = window.location.hash.replace('#', '');&#10;      setActive(hash || 'home');&#10;    } else {&#10;      // On non-home pages, no section should be active&#10;      setActive('');&#10;    }&#10;  }, [pathname, isHome]);&#10;&#10;  // Escape key to close&#10;  useEffect(() =&gt; {&#10;    if (!mobileOpen) return;&#10;    const onKey = (e: KeyboardEvent) =&gt; {&#10;      if (e.key === 'Escape') setMobileOpen(false);&#10;    };&#10;    window.addEventListener('keydown', onKey);&#10;    return () =&gt; window.removeEventListener('keydown', onKey);&#10;  }, [mobileOpen]);&#10;&#10;  // Scroll listener for background/blur changes and section tracking&#10;  useEffect(() =&gt; {&#10;    const onScroll = (scrollY?: number) =&gt; {&#10;      const currentScrollY = scrollY ?? window.scrollY;&#10;      setScrolled(currentScrollY &gt; 8);&#10;&#10;      // Additional scroll-based section detection for homepage&#10;      if (isHome) {&#10;        const sectionIds = links&#10;          .map(l =&gt; l.sectionId)&#10;          .filter((v): v is string =&gt; Boolean(v));&#10;&#10;        const offset = 120; // Account for navbar height&#10;&#10;        let currentSection = 'home'; // Default to home&#10;&#10;        // Find which section occupies the most viewport space&#10;        for (const sectionId of sectionIds) {&#10;          const element = document.getElementById(sectionId);&#10;          if (element) {&#10;            const rect = element.getBoundingClientRect();&#10;            const elementTop = rect.top + currentScrollY;&#10;            const elementBottom = elementTop + rect.height;&#10;&#10;            // Check if this section is in the &quot;active zone&quot; (top part of viewport)&#10;            if (elementTop &lt;= currentScrollY + offset &amp;&amp; elementBottom &gt; currentScrollY + offset) {&#10;              currentSection = sectionId;&#10;              break;&#10;            }&#10;          }&#10;        }&#10;&#10;        setActive(currentSection);&#10;      }&#10;    };&#10;&#10;    // Listen to Lenis scroll events if available&#10;    const handleLenisScroll = (e: Event) =&gt; {&#10;      const ce = e as CustomEvent&lt;{ scrollY: number }&gt;;&#10;      onScroll(ce.detail?.scrollY);&#10;    };&#10;&#10;    // Listen to native scroll as fallback&#10;    const handleNativeScroll = () =&gt; {&#10;      onScroll();&#10;    };&#10;&#10;    // Initial call&#10;    onScroll();&#10;&#10;    // Add event listeners&#10;    window.addEventListener('lenisScroll', handleLenisScroll as EventListener);&#10;    window.addEventListener('scroll', handleNativeScroll, { passive: true });&#10;&#10;    return () =&gt; {&#10;      window.removeEventListener('lenisScroll', handleLenisScroll as EventListener);&#10;      window.removeEventListener('scroll', handleNativeScroll);&#10;    };&#10;  }, [isHome, links]);&#10;&#10;  // Scroll spy for homepage sections only&#10;  useEffect(() =&gt; {&#10;    if (!isHome) return;&#10;&#10;    const sectionIds = links&#10;      .map(l =&gt; l.sectionId)&#10;      .filter((v): v is string =&gt; Boolean(v));&#10;&#10;    let debounceTimer: NodeJS.Timeout;&#10;&#10;    const observer = new IntersectionObserver(&#10;      entries =&gt; {&#10;        // Clear any existing timer&#10;        clearTimeout(debounceTimer);&#10;&#10;        // Debounce the update to prevent rapid switching&#10;        debounceTimer = setTimeout(() =&gt; {&#10;          // Find the section that's most visible in the viewport&#10;          let mostVisible: { id: string; ratio: number } | null = null;&#10;&#10;          for (const entry of entries) {&#10;            const id = entry.target.id;&#10;            const ratio = entry.intersectionRatio;&#10;&#10;            // Consider any section that's at least 10% visible&#10;            if (ratio &gt; 0.1) {&#10;              if (!mostVisible || ratio &gt; mostVisible.ratio) {&#10;                mostVisible = { id, ratio };&#10;              }&#10;            }&#10;          }&#10;&#10;          // If we found a visible section, activate it&#10;          if (mostVisible) {&#10;            setActive(mostVisible.id);&#10;          }&#10;        }, 100);&#10;      },&#10;      {&#10;        // Adjust root margin to account for the navbar height&#10;        rootMargin: '-80px 0px -50% 0px',&#10;        threshold: [0, 0.1, 0.25, 0.5, 0.75, 1],&#10;      }&#10;    );&#10;&#10;    const els = sectionIds&#10;      .map(id =&gt; document.getElementById(id))&#10;      .filter((el): el is HTMLElement =&gt; !!el);&#10;&#10;    els.forEach(el =&gt; observer.observe(el));&#10;&#10;    return () =&gt; {&#10;      clearTimeout(debounceTimer);&#10;      observer.disconnect();&#10;    };&#10;  }, [isHome, links]);&#10;&#10;  // Smooth scroll helper that also works when already on the homepage&#10;  const getHeaderOffset = () =&gt; {&#10;    // Only offset on desktop; mobile header is floating/transparent&#10;    const isLg = typeof window !== 'undefined' &amp;&amp; window.matchMedia('(min-width: 1024px)').matches;&#10;    if (!isLg) return 0;&#10;    const header = headerRef.current;&#10;    if (!header) return 0;&#10;    const rect = header.getBoundingClientRect();&#10;    const style = getComputedStyle(header);&#10;    const extra =&#10;      parseFloat(style.marginBottom || '0') +&#10;      parseFloat(style.borderBottomWidth || '0');&#10;    // Ceil to avoid sub-pixel gaps + 1px safety&#10;    return Math.ceil(rect.height + extra) + 1;&#10;  };&#10;&#10;  const smoothScrollTo = (hashHref: string) =&gt; {&#10;    if (!hashHref.startsWith('/#')) return; // Non-section link&#10;&#10;    const id = hashHref.replace('/#', '');&#10;    const el = document.getElementById(id);&#10;    if (!el) {&#10;      if (pathname !== '/') {&#10;        window.location.href = hashHref;&#10;      }&#10;      return;&#10;    }&#10;&#10;    const offset = getHeaderOffset();&#10;    const targetPosition = el.offsetTop - offset;&#10;&#10;    // Use Lenis if available, otherwise fall back to native smooth scroll&#10;    const lenis = (window as unknown as { lenis?: { scrollTo: (y: number, opts?: { duration?: number; easing?: (t: number) =&gt; number }) =&gt; void } }).lenis;&#10;    if (lenis) {&#10;      lenis.scrollTo(targetPosition, {&#10;        duration: 1.5,&#10;        easing: (t: number) =&gt; t &lt; 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2,&#10;      });&#10;    } else {&#10;      // Fallback to native smooth scroll&#10;      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;&#10;      window.scrollTo({&#10;        top: Math.max(0, targetPosition),&#10;        behavior: prefersReduced ? 'auto' : 'smooth'&#10;      });&#10;    }&#10;  };&#10;&#10;  // Adjust hash-based scrolling to account for fixed header on initial load and on hash changes&#10;  useEffect(() =&gt; {&#10;    const adjust = () =&gt; {&#10;      const hash = window.location.hash;&#10;      if (!hash) return;&#10;      const id = hash.replace('#', '');&#10;      const el = document.getElementById(id);&#10;      if (!el) return;&#10;      const offset = getHeaderOffset();&#10;      const y = Math.round(el.getBoundingClientRect().top + window.scrollY - offset);&#10;      // Delay to run after browser's native anchor jump&#10;      setTimeout(() =&gt; window.scrollTo({ top: Math.max(0, y), behavior: 'auto' }), 0);&#10;    };&#10;&#10;    // Run on mount and when pathname changes&#10;    adjust();&#10;    window.addEventListener('hashchange', adjust);&#10;    return () =&gt; window.removeEventListener('hashchange', adjust);&#10;  }, [pathname]);&#10;&#10;  // Visual styles&#10;  // Force transparent on mobile until scrolled; opaque on lg+&#10;  const mobileBg = scrolled&#10;    ? 'bg-white/90 backdrop-blur supports-[backdrop-filter]:bg-white/60 ring-1 ring-black/5'&#10;    : 'bg-transparent';&#10;  const baseBg = `${mobileBg} lg:bg-white lg:shadow-md`;&#10;&#10;  // Prevent background scroll when mobile menu is open&#10;  useEffect(() =&gt; {&#10;    if (mobileOpen) {&#10;      document.body.classList.add('overflow-hidden');&#10;    } else {&#10;      document.body.classList.remove('overflow-hidden');&#10;    }&#10;    return () =&gt; document.body.classList.remove('overflow-hidden');&#10;  }, [mobileOpen]);&#10;&#10;  function NavLink({&#10;    label,&#10;    href,&#10;    sectionId,&#10;    onNavigate,&#10;    className = '',&#10;  }: NavItem &amp; { onNavigate?: () =&gt; void; className?: string }) {&#10;    const isActive = sectionId ? active === sectionId : pathname === href;&#10;&#10;    // For section links, intercept click to smooth scroll when possible&#10;    const handleClick = (e: React.MouseEvent) =&gt; {&#10;      if (sectionId) {&#10;        e.preventDefault();&#10;        // Immediately set the active state for better UX&#10;        setActive(sectionId);&#10;        // Close any open mobile panel first, then scroll on next frame&#10;        onNavigate?.();&#10;        requestAnimationFrame(() =&gt; smoothScrollTo(href));&#10;      } else {&#10;        onNavigate?.();&#10;      }&#10;    };&#10;&#10;    return (&#10;      &lt;Link&#10;        href={href}&#10;        aria-current={isActive ? 'page' : undefined}&#10;        className={`relative px-3 py-2 rounded-full text-sm md:text-base manrope-medium transition-colors ${&#10;          isActive ? 'text-[#2b91cb]' : 'text-gray-700 hover:text-[#2b91cb]'&#10;        } ${className}`}&#10;        onClick={handleClick}&#10;      &gt;&#10;        &lt;span&gt;{label}&lt;/span&gt;&#10;        &lt;span&#10;          className={`absolute left-1/2 -translate-x-1/2 -bottom-0.5 h-0.5 rounded-full transition-all ${&#10;            isActive ? 'w-6 bg-[#2b91cb]' : 'w-0 bg-transparent'&#10;          }`}&#10;          aria-hidden&#10;        /&gt;&#10;      &lt;/Link&gt;&#10;    );&#10;  }&#10;&#10;  // Add bottom padding on body when mobile bottom bar is present (lg hidden)&#10;  useEffect(() =&gt; {&#10;    if (typeof window === 'undefined') return;&#10;&#10;    const apply = () =&gt; {&#10;      const isMobile = window.matchMedia('(max-width: 1023.98px)').matches;&#10;      if (isMobile) {&#10;        const h = bottomBarRef.current?.offsetHeight || 0;&#10;        document.body.style.paddingBottom = h ? `${h}px` : '64px';&#10;      } else {&#10;        document.body.style.paddingBottom = '';&#10;      }&#10;    };&#10;&#10;    apply();&#10;    window.addEventListener('resize', apply);&#10;    window.addEventListener('orientationchange', apply);&#10;    return () =&gt; {&#10;      window.removeEventListener('resize', apply);&#10;      window.removeEventListener('orientationchange', apply);&#10;      document.body.style.paddingBottom = '';&#10;    };&#10;  }, []);&#10;&#10;  function MobileTabButton({&#10;    label,&#10;    icon: Icon,&#10;    href,&#10;    sectionId,&#10;    className = '',&#10;  }: { label: string; icon: LucideIcon; href: string; sectionId?: string; className?: string }) {&#10;    const pathname = usePathname();&#10;    const [active, setActive] = useState&lt;string&gt;('');&#10;&#10;    // Determine active for non-section links&#10;    const isActive = sectionId ? false : pathname === href;&#10;&#10;    const onClick = (e: React.MouseEvent) =&gt; {&#10;      if (sectionId) {&#10;        e.preventDefault();&#10;        setActive(sectionId);&#10;        const smoothScrollTo = (hashHref: string) =&gt; {&#10;          const id = hashHref.replace('/#', '');&#10;          const el = document.getElementById(id);&#10;          if (!el) {&#10;            window.location.href = hashHref;&#10;            return;&#10;          }&#10;          const y = el.offsetTop;&#10;          const lenis = (window as unknown as { lenis?: { scrollTo: (y: number, opts?: { duration?: number; easing?: (t: number) =&gt; number }) =&gt; void } }).lenis;&#10;          if (lenis) {&#10;            lenis.scrollTo(y, {&#10;              duration: 1.2,&#10;              easing: (t: number) =&gt; (t &lt; 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2),&#10;            });&#10;          } else {&#10;            window.scrollTo({ top: Math.max(0, y), behavior: 'smooth' });&#10;          }&#10;        };&#10;        smoothScrollTo(href);&#10;      }&#10;    };&#10;&#10;    return (&#10;      &lt;Link&#10;        href={href}&#10;        onClick={onClick}&#10;        className={`w-full flex flex-col items-center justify-center gap-0.5 px-2 py-1.5 rounded-xl text-[10px] font-medium transition-colors ${&#10;          isActive ? 'text-[#2b91cb]' : 'text-gray-600 hover:text-[#2b91cb]'&#10;        } ${className}`}&#10;        aria-current={isActive ? 'page' : undefined}&#10;      &gt;&#10;        &lt;Icon className={`h-5 w-5 ${isActive ? 'text-[#2b91cb]' : 'text-gray-600'}`} /&gt;&#10;        &lt;span className=&quot;leading-none&quot;&gt;{label}&lt;/span&gt;&#10;      &lt;/Link&gt;&#10;    );&#10;  }&#10;&#10;  return (&#10;    &lt;&gt;&#10;    &lt;header ref={(el) =&gt; { headerRef.current = el; }} className={`fixed top-0 left-0 right-0 z-[1000] hidden lg:block ${baseBg}`} style={{ paddingTop: 'env(safe-area-inset-top)' }}&gt;&#10;      &lt;nav className=&quot;max-w-7xl mx-auto px-3 sm:px-6 lg:px-8&quot; aria-label=&quot;Primary&quot;&gt;&#10;        {/* Top bar */}&#10;        &lt;div ref={topBarRef} className=&quot;h-14 md:h-20 flex items-center justify-between gap-2 md:gap-3&quot;&gt;&#10;          {/* Left: Logo */}&#10;          &lt;Link href=&quot;/&quot; className=&quot;flex items-center gap-2 group shrink-0&quot; aria-label=&quot;Makers of Milkshakes - Home&quot;&gt;&#10;            &lt;Image&#10;              src=&quot;/logo.png&quot;&#10;              alt=&quot;Makers of Milkshakes Logo&quot;&#10;              width={40}&#10;              height={40}&#10;              className=&quot;w-8 h-8 md:w-10 md:h-10 transition-transform group-hover:scale-105&quot;&#10;              priority&#10;            /&gt;&#10;            &lt;span className=&quot;hidden md:inline text-lg syne-bold text-[#2b91cb]&quot;&gt;Makers of Milkshakes&lt;/span&gt;&#10;          &lt;/Link&gt;&#10;&#10;          {/* Center: Desktop nav */}&#10;          &lt;div className=&quot;hidden lg:flex items-center gap-1&quot;&gt;&#10;            {links.map(l =&gt; (&#10;              &lt;NavLink key={l.label} label={l.label} href={l.href} sectionId={l.sectionId} /&gt;&#10;            ))}&#10;          &lt;/div&gt;&#10;&#10;          {/* Right: Desktop CTA &amp; Mobile Hamburger */}&#10;          &lt;div className=&quot;flex items-center gap-2&quot;&gt;&#10;            &lt;div className=&quot;hidden lg:flex items-center gap-2&quot;&gt;&#10;              &lt;Link&#10;                href=&quot;/#franchise&quot;&#10;                className=&quot;inline-flex items-center justify-center px-4 py-2 rounded-full text-white bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 transition-colors shadow-sm&quot;&#10;                onClick={e =&gt; {&#10;                  if (isHome) {&#10;                    e.preventDefault();&#10;                    smoothScrollTo('/#franchise');&#10;                  }&#10;                }}&#10;              &gt;&#10;                Franchise With Us&#10;              &lt;/Link&gt;&#10;            &lt;/div&gt;&#10;&#10;            {/* Mobile hamburger */}&#10;            {/* Hidden on mobile as header is hidden; keep for lg+ */}&#10;            &lt;button&#10;              type=&quot;button&quot;&#10;              className=&quot;lg:hidden inline-flex items-center justify-center h-9 w-9 rounded-full bg-white text-gray-800 ring-1 ring-black/10 shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-[#2b91cb]&quot;&#10;              aria-label={mobileOpen ? 'Close menu' : 'Open menu'}&#10;              aria-expanded={mobileOpen}&#10;              aria-controls=&quot;mobile-menu&quot;&#10;              onClick={() =&gt; setMobileOpen(o =&gt; !o)}&#10;            &gt;&#10;              {!mobileOpen ? (&#10;                &lt;svg className=&quot;h-5 w-5&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; fill=&quot;none&quot; viewBox=&quot;0 0 24 24&quot; strokeWidth={1.5} stroke=&quot;currentColor&quot; aria-hidden=&quot;true&quot;&gt;&#10;                  &lt;path strokeLinecap=&quot;round&quot; strokeLinejoin=&quot;round&quot; d=&quot;M3.75 6.75h16.5M3.75 12h16.5M3.75 17.25h16.5&quot; /&gt;&#10;                &lt;/svg&gt;&#10;              ) : (&#10;                &lt;svg className=&quot;h-5 w-5&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; fill=&quot;none&quot; viewBox=&quot;0 0 24 24&quot; strokeWidth={1.5} stroke=&quot;currentColor&quot; aria-hidden=&quot;true&quot;&gt;&#10;                  &lt;path strokeLinecap=&quot;round&quot; strokeLinejoin=&quot;round&quot; d=&quot;M6 18L18 6M6 6l12 12&quot; /&gt;&#10;                &lt;/svg&gt;&#10;              )}&#10;            &lt;/button&gt;&#10;          &lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        {/* Mobile backdrop overlay */}&#10;        {mobileOpen &amp;&amp; (&#10;          &lt;div&#10;            className=&quot;lg:hidden fixed inset-0 z-[900] bg-black/40 animate-fade-in&quot;&#10;            aria-hidden&#10;            onClick={() =&gt; setMobileOpen(false)}&#10;            data-lenis-prevent&#10;          /&gt;&#10;        )}&#10;&#10;        {/* Mobile: slide-down panel below top bar */}&#10;        &lt;div className=&quot;lg:hidden relative z-[1001]&quot; id=&quot;mobile-menu&quot; role=&quot;region&quot; aria-label=&quot;Mobile menu&quot;&gt;&#10;          {mobileOpen &amp;&amp; (&#10;            &lt;div className=&quot;mt-2 mb-3 rounded-2xl bg-white ring-1 ring-gray-200 shadow-md p-2 animate-fade-in&quot; data-lenis-prevent&gt;&#10;              &lt;div className=&quot;flex flex-col gap-1&quot;&gt;&#10;                {links.map(l =&gt; (&#10;                  &lt;NavLink&#10;                    key={l.label}&#10;                    label={l.label}&#10;                    href={l.href}&#10;                    sectionId={l.sectionId}&#10;                    onNavigate={() =&gt; setMobileOpen(false)}&#10;                    className=&quot;block w-full px-3 py-3 rounded-xl text-base hover:bg-gray-50&quot;&#10;                  /&gt;&#10;                ))}&#10;              &lt;/div&gt;&#10;              &lt;div className=&quot;pt-2 grid grid-cols-1 gap-2&quot;&gt;&#10;                &lt;Link&#10;                  href=&quot;/store-locator&quot;&#10;                  className=&quot;block w-full text-center px-4 py-3 rounded-xl text-white bg-[#2b91cb] hover:bg-[#1e7bb8] transition-colors shadow-sm&quot;&#10;                  onClick={() =&gt; setMobileOpen(false)}&#10;                &gt;&#10;                  Store Locator&#10;                &lt;/Link&gt;&#10;                &lt;Link&#10;                  href=&quot;/#franchise&quot;&#10;                  className=&quot;block w-full text-center px-4 py-3 rounded-xl text-white bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 transition-colors shadow-sm&quot;&#10;                  onClick={e =&gt; {&#10;                    if (isHome) {&#10;                      e.preventDefault();&#10;                      smoothScrollTo('/#franchise');&#10;                    }&#10;                    setMobileOpen(false);&#10;                  }}&#10;                &gt;&#10;                  Franchise With Us&#10;                &lt;/Link&gt;&#10;              &lt;/div&gt;&#10;              &lt;div className=&quot;h-[env(safe-area-inset-bottom)]&quot; /&gt;&#10;            &lt;/div&gt;&#10;          )}&#10;        &lt;/div&gt;&#10;      &lt;/nav&gt;&#10;    &lt;/header&gt;&#10;&#10;    {/* Mobile Bottom Nav */}&#10;    &lt;div className=&quot;lg:hidden fixed inset-x-0 bottom-0 z-[999]&quot;&gt;&#10;      &lt;div className=&quot;relative max-w-7xl mx-auto px-4&quot;&gt;&#10;        {/* Bar */}&#10;        &lt;div ref={(el) =&gt; { bottomBarRef.current = el; }} className=&quot;h-12 rounded-2xl bg-white/90 backdrop-blur supports-[backdrop-filter]:bg-white/70 shadow-[0_-6px_24px_rgba(0,0,0,0.08)] ring-1 ring-black/5 grid grid-cols-5 gap-0 px-2 items-stretch&quot;&gt;&#10;          {/* Left two tabs */}&#10;          &lt;MobileTabButton label=&quot;Home&quot; icon={Home} href=&quot;/#home&quot; sectionId=&quot;home&quot; /&gt;&#10;          &lt;MobileTabButton label=&quot;Menu&quot; icon={BookOpen} href=&quot;/#menu&quot; sectionId=&quot;menu&quot; /&gt;&#10;          {/* Middle spacer for Franchise CTA */}&#10;          &lt;div aria-hidden className=&quot;w-full&quot; /&gt;&#10;          {/* Right two tabs */}&#10;          &lt;MobileTabButton label=&quot;Stores&quot; icon={StoreIcon} href=&quot;/store-locator&quot; /&gt;&#10;          &lt;MobileTabButton label=&quot;Contact&quot; icon={PhoneIcon} href=&quot;/contact&quot; /&gt;&#10;        &lt;/div&gt;&#10;        {/* Floating Franchise CTA */}&#10;        &lt;div className=&quot;absolute left-1/2 -translate-x-1/2 -top-5&quot;&gt;&#10;          &lt;Link&#10;            href=&quot;/#franchise&quot;&#10;            onClick={(e) =&gt; {&#10;              if (isHome) {&#10;                e.preventDefault();&#10;                smoothScrollTo('/#franchise');&#10;              }&#10;            }}&#10;            className=&quot;inline-flex items-center justify-center h-12 w-12 rounded-full bg-[#2b91cb] text-white shadow-lg ring-4 ring-white/80 hover:bg-[#1e7bb8] transition-colors&quot;&#10;            aria-label=&quot;Franchise With Us&quot;&#10;          &gt;&#10;            &lt;Building2 className=&quot;h-5 w-5&quot; /&gt;&#10;          &lt;/Link&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;      &lt;div className=&quot;h-[env(safe-area-inset-bottom)]&quot; /&gt;&#10;    &lt;/div&gt;&#10;    &lt;/&gt;&#10;   );&#10; }&#10;&#10;function MobileTabButton({&#10;  label,&#10;  icon: Icon,&#10;  href,&#10;  sectionId,&#10;  className = '',&#10;}: { label: string; icon: LucideIcon; href: string; sectionId?: string; className?: string }) {&#10;  const pathname = usePathname();&#10;  const [active, setActive] = useState&lt;string&gt;('');&#10;&#10;  // Determine active for non-section links&#10;  const isActive = sectionId ? false : pathname === href;&#10;&#10;  const onClick = (e: React.MouseEvent) =&gt; {&#10;    if (sectionId) {&#10;      e.preventDefault();&#10;      setActive(sectionId);&#10;      const smoothScrollTo = (hashHref: string) =&gt; {&#10;        const id = hashHref.replace('/#', '');&#10;        const el = document.getElementById(id);&#10;        if (!el) {&#10;          window.location.href = hashHref;&#10;          return;&#10;        }&#10;        const y = el.offsetTop;&#10;        const lenis = (window as unknown as { lenis?: { scrollTo: (y: number, opts?: { duration?: number; easing?: (t: number) =&gt; number }) =&gt; void } }).lenis;&#10;        if (lenis) {&#10;          lenis.scrollTo(y, {&#10;            duration: 1.2,&#10;            easing: (t: number) =&gt; (t &lt; 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2),&#10;          });&#10;        } else {&#10;          window.scrollTo({ top: Math.max(0, y), behavior: 'smooth' });&#10;        }&#10;      };&#10;      smoothScrollTo(href);&#10;    }&#10;  };&#10;&#10;  return (&#10;    &lt;Link&#10;      href={href}&#10;      onClick={onClick}&#10;      className={`w-full flex flex-col items-center justify-center gap-0.5 px-2 py-1.5 rounded-xl text-[10px] font-medium transition-colors ${&#10;        isActive ? 'text-[#2b91cb]' : 'text-gray-600 hover:text-[#2b91cb]'&#10;      } ${className}`}&#10;      aria-current={isActive ? 'page' : undefined}&#10;    &gt;&#10;      &lt;Icon className={`h-5 w-5 ${isActive ? 'text-[#2b91cb]' : 'text-gray-600'}`} /&gt;&#10;      &lt;span className=&quot;leading-none&quot;&gt;{label}&lt;/span&gt;&#10;    &lt;/Link&gt;&#10;  );&#10;}&#10;" />
              <option name="updatedContent" value="'use client';&#10;&#10;import Link from 'next/link';&#10;import Image from 'next/image';&#10;import { useEffect, useMemo, useRef, useState } from 'react';&#10;import { usePathname } from 'next/navigation';&#10;import { Home, BookOpen, Phone as PhoneIcon, Store as StoreIcon, Building2 } from 'lucide-react';&#10;import type { LucideIcon } from 'lucide-react';&#10;&#10;// Link type for nav items&#10;type NavItem = {&#10;  label: string;&#10;  href: string; // can be &quot;/#section&quot; or a route&#10;  sectionId?: string; // present if it's a home section link&#10;};&#10;&#10;// A fresh, polished navbar optimized for the homepage but safe globally&#10;export default function Navbar() {&#10;  const pathname = usePathname();&#10;  const isHome = pathname === '/';&#10;&#10;  const [scrolled, setScrolled] = useState(false);&#10;  const [active, setActive] = useState&lt;string&gt;(() =&gt; {&#10;    // Initialize based on URL hash if present, otherwise default to home&#10;    if (typeof window !== 'undefined') {&#10;      const hash = window.location.hash.replace('#', '');&#10;      return hash || 'home';&#10;    }&#10;    return 'home';&#10;  });&#10;  const [mobileOpen, setMobileOpen] = useState(false);&#10;  const headerRef = useRef&lt;HTMLElement | null&gt;(null);&#10;  const topBarRef = useRef&lt;HTMLDivElement | null&gt;(null);&#10;  const bottomBarRef = useRef&lt;HTMLDivElement | null&gt;(null);&#10;&#10;  // Central definition of links; section links are anchored to home&#10;  const links: NavItem[] = useMemo(&#10;    () =&gt; [&#10;      { label: 'Home', href: '/#home', sectionId: 'home' },&#10;      { label: 'Our Story', href: '/#our-story', sectionId: 'our-story' },&#10;      { label: 'Menu', href: '/#menu', sectionId: 'menu' },&#10;      { label: 'Gallery', href: '/#gallery', sectionId: 'gallery' },&#10;      // Removed 'Franchise' from main links to avoid repetition with CTA&#10;      { label: 'Store Locator', href: '/store-locator' },&#10;      { label: 'Contact', href: '/contact' },&#10;    ],&#10;    []&#10;  );&#10;&#10;  // Close mobile menu on route change and handle section activation&#10;  useEffect(() =&gt; {&#10;    setMobileOpen(false);&#10;&#10;    // Reset active section when navigating to/from home&#10;    if (isHome) {&#10;      const hash = window.location.hash.replace('#', '');&#10;      setActive(hash || 'home');&#10;    } else {&#10;      // On non-home pages, no section should be active&#10;      setActive('');&#10;    }&#10;  }, [pathname, isHome]);&#10;&#10;  // Escape key to close&#10;  useEffect(() =&gt; {&#10;    if (!mobileOpen) return;&#10;    const onKey = (e: KeyboardEvent) =&gt; {&#10;      if (e.key === 'Escape') setMobileOpen(false);&#10;    };&#10;    window.addEventListener('keydown', onKey);&#10;    return () =&gt; window.removeEventListener('keydown', onKey);&#10;  }, [mobileOpen]);&#10;&#10;  // Scroll listener for background/blur changes and section tracking&#10;  useEffect(() =&gt; {&#10;    const onScroll = (scrollY?: number) =&gt; {&#10;      const currentScrollY = scrollY ?? window.scrollY;&#10;      setScrolled(currentScrollY &gt; 8);&#10;&#10;      // Additional scroll-based section detection for homepage&#10;      if (isHome) {&#10;        const sectionIds = links&#10;          .map(l =&gt; l.sectionId)&#10;          .filter((v): v is string =&gt; Boolean(v));&#10;&#10;        const offset = 120; // Account for navbar height&#10;&#10;        let currentSection = 'home'; // Default to home&#10;&#10;        // Find which section occupies the most viewport space&#10;        for (const sectionId of sectionIds) {&#10;          const element = document.getElementById(sectionId);&#10;          if (element) {&#10;            const rect = element.getBoundingClientRect();&#10;            const elementTop = rect.top + currentScrollY;&#10;            const elementBottom = elementTop + rect.height;&#10;&#10;            // Check if this section is in the &quot;active zone&quot; (top part of viewport)&#10;            if (elementTop &lt;= currentScrollY + offset &amp;&amp; elementBottom &gt; currentScrollY + offset) {&#10;              currentSection = sectionId;&#10;              break;&#10;            }&#10;          }&#10;        }&#10;&#10;        setActive(currentSection);&#10;      }&#10;    };&#10;&#10;    // Listen to Lenis scroll events if available&#10;    const handleLenisScroll = (e: Event) =&gt; {&#10;      const ce = e as CustomEvent&lt;{ scrollY: number }&gt;;&#10;      onScroll(ce.detail?.scrollY);&#10;    };&#10;&#10;    // Listen to native scroll as fallback&#10;    const handleNativeScroll = () =&gt; {&#10;      onScroll();&#10;    };&#10;&#10;    // Initial call&#10;    onScroll();&#10;&#10;    // Add event listeners&#10;    window.addEventListener('lenisScroll', handleLenisScroll as EventListener);&#10;    window.addEventListener('scroll', handleNativeScroll, { passive: true });&#10;&#10;    return () =&gt; {&#10;      window.removeEventListener('lenisScroll', handleLenisScroll as EventListener);&#10;      window.removeEventListener('scroll', handleNativeScroll);&#10;    };&#10;  }, [isHome, links]);&#10;&#10;  // Scroll spy for homepage sections only&#10;  useEffect(() =&gt; {&#10;    if (!isHome) return;&#10;&#10;    const sectionIds = links&#10;      .map(l =&gt; l.sectionId)&#10;      .filter((v): v is string =&gt; Boolean(v));&#10;&#10;    let debounceTimer: NodeJS.Timeout;&#10;&#10;    const observer = new IntersectionObserver(&#10;      entries =&gt; {&#10;        // Clear any existing timer&#10;        clearTimeout(debounceTimer);&#10;&#10;        // Debounce the update to prevent rapid switching&#10;        debounceTimer = setTimeout(() =&gt; {&#10;          // Find the section that's most visible in the viewport&#10;          let mostVisible: { id: string; ratio: number } | null = null;&#10;&#10;          for (const entry of entries) {&#10;            const id = entry.target.id;&#10;            const ratio = entry.intersectionRatio;&#10;&#10;            // Consider any section that's at least 10% visible&#10;            if (ratio &gt; 0.1) {&#10;              if (!mostVisible || ratio &gt; mostVisible.ratio) {&#10;                mostVisible = { id, ratio };&#10;              }&#10;            }&#10;          }&#10;&#10;          // If we found a visible section, activate it&#10;          if (mostVisible) {&#10;            setActive(mostVisible.id);&#10;          }&#10;        }, 100);&#10;      },&#10;      {&#10;        // Adjust root margin to account for the navbar height&#10;        rootMargin: '-80px 0px -50% 0px',&#10;        threshold: [0, 0.1, 0.25, 0.5, 0.75, 1],&#10;      }&#10;    );&#10;&#10;    const els = sectionIds&#10;      .map(id =&gt; document.getElementById(id))&#10;      .filter((el): el is HTMLElement =&gt; !!el);&#10;&#10;    els.forEach(el =&gt; observer.observe(el));&#10;&#10;    return () =&gt; {&#10;      clearTimeout(debounceTimer);&#10;      observer.disconnect();&#10;    };&#10;  }, [isHome, links]);&#10;&#10;  // Smooth scroll helper that also works when already on the homepage&#10;  const getHeaderOffset = () =&gt; {&#10;    // Only offset on desktop; mobile header is floating/transparent&#10;    const isLg = typeof window !== 'undefined' &amp;&amp; window.matchMedia('(min-width: 1024px)').matches;&#10;    if (!isLg) return 0;&#10;    const header = headerRef.current;&#10;    if (!header) return 0;&#10;    const rect = header.getBoundingClientRect();&#10;    const style = getComputedStyle(header);&#10;    const extra =&#10;      parseFloat(style.marginBottom || '0') +&#10;      parseFloat(style.borderBottomWidth || '0');&#10;    // Ceil to avoid sub-pixel gaps + 1px safety&#10;    return Math.ceil(rect.height + extra) + 1;&#10;  };&#10;&#10;  const smoothScrollTo = (hashHref: string) =&gt; {&#10;    if (!hashHref.startsWith('/#')) return; // Non-section link&#10;&#10;    const id = hashHref.replace('/#', '');&#10;    const el = document.getElementById(id);&#10;    if (!el) {&#10;      if (pathname !== '/') {&#10;        window.location.href = hashHref;&#10;      }&#10;      return;&#10;    }&#10;&#10;    const offset = getHeaderOffset();&#10;    const targetPosition = el.offsetTop - offset;&#10;&#10;    // Use Lenis if available, otherwise fall back to native smooth scroll&#10;    const lenis = (window as unknown as { lenis?: { scrollTo: (y: number, opts?: { duration?: number; easing?: (t: number) =&gt; number }) =&gt; void } }).lenis;&#10;    if (lenis) {&#10;      lenis.scrollTo(targetPosition, {&#10;        duration: 1.5,&#10;        easing: (t: number) =&gt; t &lt; 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2,&#10;      });&#10;    } else {&#10;      // Fallback to native smooth scroll&#10;      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;&#10;      window.scrollTo({&#10;        top: Math.max(0, targetPosition),&#10;        behavior: prefersReduced ? 'auto' : 'smooth'&#10;      });&#10;    }&#10;  };&#10;&#10;  // Adjust hash-based scrolling to account for fixed header on initial load and on hash changes&#10;  useEffect(() =&gt; {&#10;    const adjust = () =&gt; {&#10;      const hash = window.location.hash;&#10;      if (!hash) return;&#10;      const id = hash.replace('#', '');&#10;      const el = document.getElementById(id);&#10;      if (!el) return;&#10;      const offset = getHeaderOffset();&#10;      const y = Math.round(el.getBoundingClientRect().top + window.scrollY - offset);&#10;      // Delay to run after browser's native anchor jump&#10;      setTimeout(() =&gt; window.scrollTo({ top: Math.max(0, y), behavior: 'auto' }), 0);&#10;    };&#10;&#10;    // Run on mount and when pathname changes&#10;    adjust();&#10;    window.addEventListener('hashchange', adjust);&#10;    return () =&gt; window.removeEventListener('hashchange', adjust);&#10;  }, [pathname]);&#10;&#10;  // Visual styles&#10;  // Force transparent on mobile until scrolled; opaque on lg+&#10;  const mobileBg = scrolled&#10;    ? 'bg-white/90 backdrop-blur supports-[backdrop-filter]:bg-white/60 ring-1 ring-black/5'&#10;    : 'bg-transparent';&#10;  const baseBg = `${mobileBg} lg:bg-white lg:shadow-md`;&#10;&#10;  // Prevent background scroll when mobile menu is open&#10;  useEffect(() =&gt; {&#10;    if (mobileOpen) {&#10;      document.body.classList.add('overflow-hidden');&#10;    } else {&#10;      document.body.classList.remove('overflow-hidden');&#10;    }&#10;    return () =&gt; document.body.classList.remove('overflow-hidden');&#10;  }, [mobileOpen]);&#10;&#10;  function NavLink({&#10;    label,&#10;    href,&#10;    sectionId,&#10;    onNavigate,&#10;    className = '',&#10;  }: NavItem &amp; { onNavigate?: () =&gt; void; className?: string }) {&#10;    const isActive = sectionId ? active === sectionId : pathname === href;&#10;&#10;    // For section links, intercept click to smooth scroll when possible&#10;    const handleClick = (e: React.MouseEvent) =&gt; {&#10;      if (sectionId) {&#10;        e.preventDefault();&#10;        // Immediately set the active state for better UX&#10;        setActive(sectionId);&#10;        // Close any open mobile panel first, then scroll on next frame&#10;        onNavigate?.();&#10;        requestAnimationFrame(() =&gt; smoothScrollTo(href));&#10;      } else {&#10;        onNavigate?.();&#10;      }&#10;    };&#10;&#10;    return (&#10;      &lt;Link&#10;        href={href}&#10;        aria-current={isActive ? 'page' : undefined}&#10;        className={`relative px-3 py-2 rounded-full text-sm md:text-base manrope-medium transition-colors ${&#10;          isActive ? 'text-[#2b91cb]' : 'text-gray-700 hover:text-[#2b91cb]'&#10;        } ${className}`}&#10;        onClick={handleClick}&#10;      &gt;&#10;        &lt;span&gt;{label}&lt;/span&gt;&#10;        &lt;span&#10;          className={`absolute left-1/2 -translate-x-1/2 -bottom-0.5 h-0.5 rounded-full transition-all ${&#10;            isActive ? 'w-6 bg-[#2b91cb]' : 'w-0 bg-transparent'&#10;          }`}&#10;          aria-hidden&#10;        /&gt;&#10;      &lt;/Link&gt;&#10;    );&#10;  }&#10;&#10;  // Add bottom padding on body when mobile bottom bar is present (lg hidden)&#10;  useEffect(() =&gt; {&#10;    if (typeof window === 'undefined') return;&#10;&#10;    const apply = () =&gt; {&#10;      const isMobile = window.matchMedia('(max-width: 1023.98px)').matches;&#10;      if (isMobile) {&#10;        const h = bottomBarRef.current?.offsetHeight || 0;&#10;        document.body.style.paddingBottom = h ? `${h}px` : '64px';&#10;      } else {&#10;        document.body.style.paddingBottom = '';&#10;      }&#10;    };&#10;&#10;    apply();&#10;    window.addEventListener('resize', apply);&#10;    window.addEventListener('orientationchange', apply);&#10;    return () =&gt; {&#10;      window.removeEventListener('resize', apply);&#10;      window.removeEventListener('orientationchange', apply);&#10;      document.body.style.paddingBottom = '';&#10;    };&#10;  }, []);&#10;&#10;  function MobileTabButton({&#10;    label,&#10;    icon: Icon,&#10;    href,&#10;    sectionId,&#10;    className = '',&#10;  }: { label: string; icon: LucideIcon; href: string; sectionId?: string; className?: string }) {&#10;    const pathname = usePathname();&#10;    const [active, setActive] = useState&lt;string&gt;('');&#10;&#10;    // Determine active for non-section links&#10;    const isActive = sectionId ? false : pathname === href;&#10;&#10;    const onClick = (e: React.MouseEvent) =&gt; {&#10;      if (sectionId) {&#10;        e.preventDefault();&#10;        setActive(sectionId);&#10;        const smoothScrollTo = (hashHref: string) =&gt; {&#10;          const id = hashHref.replace('/#', '');&#10;          const el = document.getElementById(id);&#10;          if (!el) {&#10;            window.location.href = hashHref;&#10;            return;&#10;          }&#10;          const y = el.offsetTop;&#10;          const lenis = (window as unknown as { lenis?: { scrollTo: (y: number, opts?: { duration?: number; easing?: (t: number) =&gt; number }) =&gt; void } }).lenis;&#10;          if (lenis) {&#10;            lenis.scrollTo(y, {&#10;              duration: 1.2,&#10;              easing: (t: number) =&gt; (t &lt; 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2),&#10;            });&#10;          } else {&#10;            window.scrollTo({ top: Math.max(0, y), behavior: 'smooth' });&#10;          }&#10;        };&#10;        smoothScrollTo(href);&#10;      }&#10;    };&#10;&#10;    return (&#10;      &lt;Link&#10;        href={href}&#10;        onClick={onClick}&#10;        className={`w-full flex flex-col items-center justify-center gap-0.5 px-2 py-1.5 rounded-xl text-[10px] font-medium transition-colors ${&#10;          isActive ? 'text-[#2b91cb]' : 'text-gray-600 hover:text-[#2b91cb]'&#10;        } ${className}`}&#10;        aria-current={isActive ? 'page' : undefined}&#10;      &gt;&#10;        &lt;Icon className={`h-5 w-5 ${isActive ? 'text-[#2b91cb]' : 'text-gray-600'}`} /&gt;&#10;        &lt;span className=&quot;leading-none&quot;&gt;{label}&lt;/span&gt;&#10;      &lt;/Link&gt;&#10;    );&#10;  }&#10;&#10;  return (&#10;    &lt;&gt;&#10;    &lt;header ref={(el) =&gt; { headerRef.current = el; }} className={`fixed top-0 left-0 right-0 z-[1000] hidden lg:block ${baseBg}`} style={{ paddingTop: 'env(safe-area-inset-top)' }}&gt;&#10;      &lt;nav className=&quot;max-w-7xl mx-auto px-3 sm:px-6 lg:px-8&quot; aria-label=&quot;Primary&quot;&gt;&#10;        {/* Top bar */}&#10;        &lt;div ref={topBarRef} className=&quot;h-14 md:h-20 flex items-center justify-between gap-2 md:gap-3&quot;&gt;&#10;          {/* Left: Logo */}&#10;          &lt;Link href=&quot;/&quot; className=&quot;flex items-center gap-2 group shrink-0&quot; aria-label=&quot;Makers of Milkshakes - Home&quot;&gt;&#10;            &lt;Image&#10;              src=&quot;/logo.png&quot;&#10;              alt=&quot;Makers of Milkshakes Logo&quot;&#10;              width={40}&#10;              height={40}&#10;              className=&quot;w-8 h-8 md:w-10 md:h-10 transition-transform group-hover:scale-105&quot;&#10;              priority&#10;            /&gt;&#10;            &lt;span className=&quot;hidden md:inline text-lg syne-bold text-[#2b91cb]&quot;&gt;Makers of Milkshakes&lt;/span&gt;&#10;          &lt;/Link&gt;&#10;&#10;          {/* Center: Desktop nav */}&#10;          &lt;div className=&quot;hidden lg:flex items-center gap-1&quot;&gt;&#10;            {links.map(l =&gt; (&#10;              &lt;NavLink key={l.label} label={l.label} href={l.href} sectionId={l.sectionId} /&gt;&#10;            ))}&#10;          &lt;/div&gt;&#10;&#10;          {/* Right: Desktop CTA &amp; Mobile Hamburger */}&#10;          &lt;div className=&quot;flex items-center gap-2&quot;&gt;&#10;            &lt;div className=&quot;hidden lg:flex items-center gap-2&quot;&gt;&#10;              &lt;Link&#10;                href=&quot;/#franchise&quot;&#10;                className=&quot;inline-flex items-center justify-center px-4 py-2 rounded-full text-white bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 transition-colors shadow-sm&quot;&#10;                onClick={e =&gt; {&#10;                  if (isHome) {&#10;                    e.preventDefault();&#10;                    smoothScrollTo('/#franchise');&#10;                  }&#10;                }}&#10;              &gt;&#10;                Franchise With Us&#10;              &lt;/Link&gt;&#10;            &lt;/div&gt;&#10;&#10;            {/* Mobile hamburger */}&#10;            {/* Hidden on mobile as header is hidden; keep for lg+ */}&#10;            &lt;button&#10;              type=&quot;button&quot;&#10;              className=&quot;lg:hidden inline-flex items-center justify-center h-9 w-9 rounded-full bg-white text-gray-800 ring-1 ring-black/10 shadow-sm focus:outline-none focus-visible:ring-2 focus-visible:ring-[#2b91cb]&quot;&#10;              aria-label={mobileOpen ? 'Close menu' : 'Open menu'}&#10;              aria-expanded={mobileOpen}&#10;              aria-controls=&quot;mobile-menu&quot;&#10;              onClick={() =&gt; setMobileOpen(o =&gt; !o)}&#10;            &gt;&#10;              {!mobileOpen ? (&#10;                &lt;svg className=&quot;h-5 w-5&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; fill=&quot;none&quot; viewBox=&quot;0 0 24 24&quot; strokeWidth={1.5} stroke=&quot;currentColor&quot; aria-hidden=&quot;true&quot;&gt;&#10;                  &lt;path strokeLinecap=&quot;round&quot; strokeLinejoin=&quot;round&quot; d=&quot;M3.75 6.75h16.5M3.75 12h16.5M3.75 17.25h16.5&quot; /&gt;&#10;                &lt;/svg&gt;&#10;              ) : (&#10;                &lt;svg className=&quot;h-5 w-5&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; fill=&quot;none&quot; viewBox=&quot;0 0 24 24&quot; strokeWidth={1.5} stroke=&quot;currentColor&quot; aria-hidden=&quot;true&quot;&gt;&#10;                  &lt;path strokeLinecap=&quot;round&quot; strokeLinejoin=&quot;round&quot; d=&quot;M6 18L18 6M6 6l12 12&quot; /&gt;&#10;                &lt;/svg&gt;&#10;              )}&#10;            &lt;/button&gt;&#10;          &lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        {/* Mobile backdrop overlay */}&#10;        {mobileOpen &amp;&amp; (&#10;          &lt;div&#10;            className=&quot;lg:hidden fixed inset-0 z-[900] bg-black/40 animate-fade-in&quot;&#10;            aria-hidden&#10;            onClick={() =&gt; setMobileOpen(false)}&#10;            data-lenis-prevent&#10;          /&gt;&#10;        )}&#10;&#10;        {/* Mobile: slide-down panel below top bar */}&#10;        &lt;div className=&quot;lg:hidden relative z-[1001]&quot; id=&quot;mobile-menu&quot; role=&quot;region&quot; aria-label=&quot;Mobile menu&quot;&gt;&#10;          {mobileOpen &amp;&amp; (&#10;            &lt;div className=&quot;mt-2 mb-3 rounded-2xl bg-white ring-1 ring-gray-200 shadow-md p-2 animate-fade-in&quot; data-lenis-prevent&gt;&#10;              &lt;div className=&quot;flex flex-col gap-1&quot;&gt;&#10;                {links.map(l =&gt; (&#10;                  &lt;NavLink&#10;                    key={l.label}&#10;                    label={l.label}&#10;                    href={l.href}&#10;                    sectionId={l.sectionId}&#10;                    onNavigate={() =&gt; setMobileOpen(false)}&#10;                    className=&quot;block w-full px-3 py-3 rounded-xl text-base hover:bg-gray-50&quot;&#10;                  /&gt;&#10;                ))}&#10;              &lt;/div&gt;&#10;              &lt;div className=&quot;pt-2 grid grid-cols-1 gap-2&quot;&gt;&#10;                &lt;Link&#10;                  href=&quot;/store-locator&quot;&#10;                  className=&quot;block w-full text-center px-4 py-3 rounded-xl text-white bg-[#2b91cb] hover:bg-[#1e7bb8] transition-colors shadow-sm&quot;&#10;                  onClick={() =&gt; setMobileOpen(false)}&#10;                &gt;&#10;                  Store Locator&#10;                &lt;/Link&gt;&#10;                &lt;Link&#10;                  href=&quot;/#franchise&quot;&#10;                  className=&quot;block w-full text-center px-4 py-3 rounded-xl text-white bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 transition-colors shadow-sm&quot;&#10;                  onClick={e =&gt; {&#10;                    if (isHome) {&#10;                      e.preventDefault();&#10;                      smoothScrollTo('/#franchise');&#10;                    }&#10;                    setMobileOpen(false);&#10;                  }}&#10;                &gt;&#10;                  Franchise With Us&#10;                &lt;/Link&gt;&#10;              &lt;/div&gt;&#10;              &lt;div className=&quot;h-[env(safe-area-inset-bottom)]&quot; /&gt;&#10;            &lt;/div&gt;&#10;          )}&#10;        &lt;/div&gt;&#10;      &lt;/nav&gt;&#10;    &lt;/header&gt;&#10;&#10;    {/* Mobile Bottom Nav */}&#10;    &lt;div className=&quot;lg:hidden fixed inset-x-0 bottom-0 z-[999]&quot;&gt;&#10;      &lt;div className=&quot;relative max-w-7xl mx-auto px-4&quot;&gt;&#10;        {/* Bar */}&#10;        &lt;div ref={(el) =&gt; { bottomBarRef.current = el; }} className=&quot;h-12 rounded-2xl bg-white/90 backdrop-blur supports-[backdrop-filter]:bg-white/70 shadow-[0_-6px_24px_rgba(0,0,0,0.08)] ring-1 ring-black/5 grid grid-cols-5 gap-0 px-2 items-stretch&quot;&gt;&#10;          {/* Left two tabs */}&#10;          &lt;MobileTabButton label=&quot;Home&quot; icon={Home} href=&quot;/#home&quot; sectionId=&quot;home&quot; /&gt;&#10;          &lt;MobileTabButton label=&quot;Menu&quot; icon={BookOpen} href=&quot;/#menu&quot; sectionId=&quot;menu&quot; /&gt;&#10;          {/* Middle spacer for Franchise CTA */}&#10;          &lt;div aria-hidden className=&quot;w-full&quot; /&gt;&#10;          {/* Right two tabs */}&#10;          &lt;MobileTabButton label=&quot;Stores&quot; icon={StoreIcon} href=&quot;/store-locator&quot; /&gt;&#10;          &lt;MobileTabButton label=&quot;Contact&quot; icon={PhoneIcon} href=&quot;/contact&quot; /&gt;&#10;        &lt;/div&gt;&#10;        {/* Floating Franchise CTA */}&#10;        &lt;div className=&quot;absolute left-1/2 -translate-x-1/2 -top-5&quot;&gt;&#10;          &lt;Link&#10;            href=&quot;/#franchise&quot;&#10;            onClick={(e) =&gt; {&#10;              if (isHome) {&#10;                e.preventDefault();&#10;                smoothScrollTo('/#franchise');&#10;              }&#10;            }}&#10;            className=&quot;inline-flex items-center justify-center h-12 w-12 rounded-full bg-[#2b91cb] text-white shadow-lg ring-4 ring-white/80 hover:bg-[#1e7bb8] transition-colors&quot;&#10;            aria-label=&quot;Franchise With Us&quot;&#10;          &gt;&#10;            &lt;Building2 className=&quot;h-5 w-5&quot; /&gt;&#10;          &lt;/Link&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;      &lt;div className=&quot;h-[env(safe-area-inset-bottom)]&quot; /&gt;&#10;    &lt;/div&gt;&#10;    &lt;/&gt;&#10;   );&#10; }&#10;&#10;function MobileTabButton({&#10;  label,&#10;  icon: Icon,&#10;  href,&#10;  sectionId,&#10;  className = '',&#10;}: { label: string; icon: LucideIcon; href: string; sectionId?: string; className?: string }) {&#10;  const pathname = usePathname();&#10;  const [active, setActive] = useState&lt;string&gt;('');&#10;&#10;  // Determine active for non-section links&#10;  const isActive = sectionId ? false : pathname === href;&#10;&#10;  const onClick = (e: React.MouseEvent) =&gt; {&#10;    if (sectionId) {&#10;      e.preventDefault();&#10;      setActive(sectionId);&#10;      const smoothScrollTo = (hashHref: string) =&gt; {&#10;        const id = hashHref.replace('/#', '');&#10;        const el = document.getElementById(id);&#10;        if (!el) {&#10;          window.location.href = hashHref;&#10;          return;&#10;        }&#10;        const y = el.offsetTop;&#10;        const lenis = (window as unknown as { lenis?: { scrollTo: (y: number, opts?: { duration?: number; easing?: (t: number) =&gt; number }) =&gt; void } }).lenis;&#10;        if (lenis) {&#10;          lenis.scrollTo(y, {&#10;            duration: 1.2,&#10;            easing: (t: number) =&gt; (t &lt; 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2),&#10;          });&#10;        } else {&#10;          window.scrollTo({ top: Math.max(0, y), behavior: 'smooth' });&#10;        }&#10;      };&#10;      smoothScrollTo(href);&#10;    }&#10;  };&#10;&#10;  return (&#10;    &lt;Link&#10;      href={href}&#10;      onClick={onClick}&#10;      className={`w-full flex flex-col items-center justify-center gap-0.5 px-2 py-1.5 rounded-xl text-[10px] font-medium transition-colors ${&#10;        isActive ? 'text-[#2b91cb]' : 'text-gray-600 hover:text-[#2b91cb]'&#10;      } ${className}`}&#10;      aria-current={isActive ? 'page' : undefined}&#10;    &gt;&#10;      &lt;Icon className={`h-5 w-5 ${isActive ? 'text-[#2b91cb]' : 'text-gray-600'}`} /&gt;&#10;      &lt;span className=&quot;leading-none&quot;&gt;{label}&lt;/span&gt;&#10;    &lt;/Link&gt;&#10;  );&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>